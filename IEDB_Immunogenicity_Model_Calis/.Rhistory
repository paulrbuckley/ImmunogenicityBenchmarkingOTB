library(data.table)
library(dplyr)
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../iedb_goldstandard.txt")
View(GOLD_STANDARD_DATA)
library(Biostrings)
Repitope::
GOLD_STANDARD_DATA=GOLD_STANDARD_DATA %>% filter(HLA_Allele %in% 'HLA-A*02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS
DATA_FOR_ANALYSIS %>% rename(Peptide=peptide)
library(tidyverse)
DATA_FOR_ANALYSIS %>% rename(Peptide=peptide)
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../iedb_goldstandard.txt")
GOLD_STANDARD_DATA=GOLD_STANDARD_DATA %>% filter(HLA_Allele %in% 'HLA-A*02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA)
DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA) %>% mutate(predicted_binary=ifelse(score>=0,1,0))
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA) %>% mutate(predicted_binary=ifelse(score>=0,1,0))
sum(DATA_FOR_ANALYSIS$predicted_binary==DATA_FOR_ANALYSIS$immunogenicity_binary)/nrow(DATA_FOR_ANALYSIS)
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../iedb_goldstandard.txt")
GOLD_STANDARD_DATA=GOLD_STANDARD_DATA %>% filter(HLA_Allele %in% 'HLA-A*02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA) %>% mutate(predicted_binary=ifelse(score>=0.2,1,0))
sum(DATA_FOR_ANALYSIS$predicted_binary==DATA_FOR_ANALYSIS$immunogenicity_binary)/nrow(DATA_FOR_ANALYSIS)
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../iedb_goldstandard.txt")
GOLD_STANDARD_DATA=GOLD_STANDARD_DATA %>% filter(HLA_Allele %in% 'HLA-A*02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA) %>% mutate(predicted_binary=ifelse(score>=0.3,1,0))
sum(DATA_FOR_ANALYSIS$predicted_binary==DATA_FOR_ANALYSIS$immunogenicity_binary)/nrow(DATA_FOR_ANALYSIS)
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../iedb_goldstandard.txt")
GOLD_STANDARD_DATA=GOLD_STANDARD_DATA %>% filter(HLA_Allele %in% 'HLA-A*02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA) %>% mutate(predicted_binary=ifelse(score>=0.5,1,0))
sum(DATA_FOR_ANALYSIS$predicted_binary==DATA_FOR_ANALYSIS$immunogenicity_binary)/nrow(DATA_FOR_ANALYSIS)
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../iedb_goldstandard.txt")
GOLD_STANDARD_DATA=GOLD_STANDARD_DATA %>% filter(HLA_Allele %in% 'HLA-A*02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA) %>% mutate(predicted_binary=ifelse(score>=0.5,1,0))
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(score>=0.5,"Positive","Negative"))
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
DATA_FOR_ANALYSIS
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../iedb_goldstandard.txt")
GOLD_STANDARD_DATA=GOLD_STANDARD_DATA %>% filter(HLA_Allele %in% 'HLA-A*02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative")) %>% select(!immunogenicity_binary)
DATA_FOR_ANALYSIS
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
DATA_FOR_ANALYSIS
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../iedb_goldstandard.txt")
GOLD_STANDARD_DATA=GOLD_STANDARD_DATA %>% filter(HLA_Allele %in% 'HLA-A*02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
setwd("Neoantigen_Analysis/")
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../../Neoantigen_Gold_Standard.csv")
PeptideData = fread("../../Neoantigen_Gold_Standard.csv")
PeptideData
setwd("Neoantigen_Analysis/")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../Neoantigen_Gold_Standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$predicted_binary==DATA_FOR_ANALYSIS$immunogenicity_binary)/nrow(DATA_FOR_ANALYSIS)
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData)
DATA_FOR_ANALYSIS
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
DATA_FOR_ANALYSIS
table(DATA_FOR_ANALYSIS$Immunogenicity)
table(DATA_FOR_ANALYSIS$ImmunogenicityPrediction)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
setwd("balanced_NEOANTIGEN_ANALYSIS/")
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
setwd("balanced_NEOANTIGEN_ANALYSIS/")
getwd()
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
setwd("balanced_NEOANTIGEN_ANALYSIS/")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../balanced_neoantigen_gold_standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
PeptideData
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
DATA_FOR_ANALYSIS
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
setwd("balanced_NEOANTIGEN_ANALYSIS/")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../balanced_neoantigen_gold_standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
setwd("balanced_NEOANTIGEN_ANALYSIS/")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../balanced_neoantigen_gold_standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
PeptideData
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
PeptideData = fread("../../balanced_neoantigen_gold_standard.csv")
PeptideData
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
setwd("balanced_NEOANTIGEN_ANALYSIS/")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../balanced_neoantigen_gold_standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
setwd("Neoantigen_Analysis/")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../Neoantigen_Gold_Standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
setwd("../Neoantigen_Analysis/")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../Neoantigen_Gold_Standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
PeptideData
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../HLA0201_9mers_netMHCpanEl_Goldstandard.txt")
# GOLD_STANDARD_DATA=GOLD_STANDARD_DATA %>% filter(HLA_Allele %in% 'HLA-A*02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$predicted_binary==DATA_FOR_ANALYSIS$immunogenicity_binary)/nrow(DATA_FOR_ANALYSIS)
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
DATA_FOR_ANALYSIS
GOLD_STANDARD_DATA = fread("../HLA0201_9mers_netMHCpanEl_Goldstandard.txt")
GOLD_STANDARD_DATA
DATA_FOR_ANALYSIS
DATA_FOR_ANALYSIS = fread("result.csv")
DATA_FOR_ANALYSIS
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA)
DATA_FOR_ANALYSIS
DATA_FOR_ANALYSIS = fread("result.csv")
DATA_FOR_ANALYSIS
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../HLA0201_9mers_netMHCpanEl_Goldstandard.txt")
# GOLD_STANDARD_DATA=GOLD_STANDARD_DATA %>% filter(HLA_Allele %in% 'HLA-A*02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide,ImmScore=score)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA) %>% dplyr::rename(ImmunogenicityScore=ImmScore) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
setwd("balanced_NEOANTIGEN_ANALYSIS/")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../balanced_neoantigen_gold_standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
PeptideData
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
DATA_FOR_ANALYSIS
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../NON_OVERLAP_TEST_DATA.txt")
# GOLD_STANDARD_DATA=GOLD_STANDARD_DATA %>% filter(HLA_Allele %in% 'HLA-A*02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide,ImmScore=score)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(GOLD_STANDARD_DATA) %>% dplyr::rename(ImmunogenicityScore=ImmScore) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
setwd("GBM//")
DATA_FOR_ANALYSIS = fread("result.csv")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../GBM_RUI_9mers.txt")
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
setwd("balancedGBM//")
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../BALANCED_GBM_RUI_9mers.txt")
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score) %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=0.5,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
setwd("balancedGBM//")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../BALANCED_GBM_RUI_9mers.txt")
PeptideData
DATA_FOR_ANALYSIS
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../BALANCED_GBM_RUI_9mers.txt")
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS, partial.auc=c(1, .75), partial.auc.focus="sensitivity")
library(pROC)
roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS, partial.auc=c(1, .75), partial.auc.focus="sensitivity")
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS, partial.auc=c(1, .75), partial.auc.focus="sensitivity")
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull(),"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull(),"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
setwd("../GBM/")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../GBM_RUI_9mers.txt")
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS, partial.auc=c(1, .75), partial.auc.focus="sensitivity")
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull(),"Positive","Negative"))
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../GBM_RUI_9mers.txt")
DATA_FOR_ANALYSIS
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
DATA_FOR_ANALYSIS
DATA_FOR_ANALYSIS = fread("result.csv") %>% rename(Peptide = peptide)
DATA_FOR_ANALYSIS = fread("result.csv") %>% dplyr::rename(Peptide = peptide)
PeptideData = fread("../../GBM_RUI_9mers.txt")
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS, partial.auc=c(1, .75), partial.auc.focus="sensitivity")
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull(),"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
setwd("../balanced_NEOANTIGEN_ANALYSIS/")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../balanced_neoantigen_gold_standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS, partial.auc=c(1, .75), partial.auc.focus="sensitivity")
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../balanced_neoantigen_gold_standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS, partial.auc=c(1, .75), partial.auc.focus="sensitivity")
roc1
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull(),"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
setwd(../)
setwd("../")
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../NON_OVERLAP_TEST_DATA.txt")
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide,ImmunogenicityScore=score)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS, partial.auc=c(1, .75), partial.auc.focus="sensitivity")
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../NON_OVERLAP_TEST_DATA.txt")
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide,ImmunogenicityScore=score) %>% inner_join(GOLD_STANDARD_DATA)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS, partial.auc=c(1, .75), partial.auc.focus="sensitivity")
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull(),"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
DATA_FOR_ANALYSIS
fread("result.csv")
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
DATA_FOR_ANALYSIS = fread("result.csv")
DATA_FOR_ANALYSIS
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../NON_OVERLAP_TEST_DATA.txt")
# GOLD_STANDARD_DATA=GOLD_STANDARD_DATA %>% filter(HLA_Allele %in% 'HLA-A*02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide,ImmunogenicityScore=score) %>% inner_join(GOLD_STANDARD_DATA)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS)
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
library(pROC)
DATA_FOR_ANALYSIS = fread("result.csv")
GOLD_STANDARD_DATA = fread("../NON_OVERLAP_TEST_DATA.txt")
# GOLD_STANDARD_DATA=GOLD_STANDARD_DATA %>% filter(HLA_Allele %in% 'HLA-A*02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide,ImmunogenicityScore=score) %>% inner_join(GOLD_STANDARD_DATA)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS)
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull(),"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
setwd("GBM/")
DATA_FOR_ANALYSIS = fread("result.csv") %>% dplyr::rename(Peptide = peptide)
PeptideData = fread("../../GBM_RUI_9mers.txt")
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS)
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull(),"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
setwd("../balancedGBM//")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../BALANCED_GBM_RUI_9mers.txt")
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS, partial.auc=c(1, .75), partial.auc.focus="sensitivity")
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull(),"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
getwd()
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../BALANCED_GBM_RUI_9mers.txt")
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS)
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull(),"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
source('~/OneDrive - Nexus365/Postdoc_Oxford/Immunogenicity_Benchmark/IEDB_Immunogenicity_Model_Calis/analysis.R')
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
setwd("balanced_NEOANTIGEN_ANALYSIS/")
setwd("../")
library(data.table)
library(dplyr)
library(Biostrings)
library(tidyverse)
setwd("balanced_NEOANTIGEN_ANALYSIS/")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../balanced_neoantigen_gold_standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS)
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull(),"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
setwd("../Neoantigen_Analysis/")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../Neoantigen_Gold_Standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS)
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS)
coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS  %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
,"Positive","Negative"))
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../Neoantigen_Gold_Standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS  %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
setwd("../Neoantigen_Analysis/")
DATA_FOR_ANALYSIS = fread("result.csv")
PeptideData = fread("../../Neoantigen_Gold_Standard.csv")
PeptideData=PeptideData %>% filter(HLA_Allele %in% 'HLA-A02:01') %>% filter(width(Peptide)==9)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% dplyr::rename(Peptide=peptide)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS %>% inner_join(PeptideData) %>% dplyr::rename(ImmunogenicityScore=score)
roc1=roc(Immunogenicity ~ ImmunogenicityScore,data = DATA_FOR_ANALYSIS)
DATA_FOR_ANALYSIS=DATA_FOR_ANALYSIS  %>% mutate(ImmunogenicityPrediction=ifelse(ImmunogenicityScore>=coords(roc=roc1, x="best", input="threshold", best.method="youden", transpose=F)[1]%>%pull()
,"Positive","Negative"))
sum(DATA_FOR_ANALYSIS$Immunogenicity==DATA_FOR_ANALYSIS$ImmunogenicityPrediction)/nrow(DATA_FOR_ANALYSIS)
write.csv(DATA_FOR_ANALYSIS,file="IEDBMODEL_SCORES.csv",quote=FALSE,row.names=FALSE)
